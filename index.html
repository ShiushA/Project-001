<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shiush To-Do List</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="A feature-rich to-do list application">
    <meta name="theme-color" content="#4158D0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Shiush ToDo">
    
    <!-- Favicon and PWA Icons -->
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/png" href="/icon/favicon-96x96.png" sizes="96x96">
    <link rel="apple-touch-icon" href="/icon/apple-touch-icon.png">
    <link rel="shortcut icon" href="/favicon.ico">
    
    <link rel="stylesheet" href="style.css">
    
    <!-- Preload critical assets -->
    <link rel="preload" href="script.js" as="script">
    <link rel="preload" href="pwa.js" as="script">
</head>
<body>
    <div class="container">
        <h1>Shiush To-Do List</h1>
        
        <div class="time-sections">
            <button class="section-btn active" data-section="today">Today</button>
            <button class="section-btn" data-section="tomorrow">Tomorrow</button>
            <button class="section-btn" data-section="week">This Week</button>
            <button class="section-btn" data-section="month">This Month</button>
            <button class="section-btn" data-section="year">This Year</button>
            <button class="section-btn" data-section="due">Due Tasks</button>
        </div>
        
        <div class="task-input-container">
            <input type="text" id="taskInput" placeholder="Add a new task...">
            <div class="priority-selector">
                <label>
                    <input type="radio" name="priority" value="main" checked>
                    <span class="priority-label main">Main</span>
                </label>
                <label>
                    <input type="radio" name="priority" value="sub">
                    <span class="priority-label sub">Sub</span>
                </label>
                <label>
                    <input type="radio" name="priority" value="minor">
                    <span class="priority-label minor">Minor</span>
                </label>
            </div>
            <button id="addTaskBtn">Add Task</button>
        </div>
        
        <div class="tasks-container">
            <h2 id="currentSection">Today</h2>
            <div id="tasksList"></div>
        </div>
        
        <div id="offlineIndicator" class="offline-indicator" style="display: none;">
            You are currently offline. Changes will be saved locally.
        </div>
        
        <div id="debugInfo" class="debug-info" style="display: none;">
            <button id="checkCacheBtn">Check Cache</button>
            <button id="clearCacheBtn">Clear Cache</button>
            <button id="reloadSWBtn">Reload Service Worker</button>
            <pre id="debugOutput"></pre>
        </div>
    </div>
    
    <script>
        // Inline script to handle immediate offline detection
        // This runs before external scripts load
        if (!navigator.onLine) {
            document.getElementById('offlineIndicator').style.display = 'block';
        }
        
        // Debug tools (remove in production)
        document.addEventListener('DOMContentLoaded', function() {
            // Add debug mode toggle with keyboard shortcut (Ctrl+Shift+D)
            let debugMode = false;
            const debugInfo = document.getElementById('debugInfo');
            
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.shiftKey && e.key === 'D') {
                    debugMode = !debugMode;
                    debugInfo.style.display = debugMode ? 'block' : 'none';
                }
            });
            
            // Debug buttons
            document.getElementById('checkCacheBtn').addEventListener('click', function() {
                window.checkCacheStatus().then(result => {
                    document.getElementById('debugOutput').textContent = 'Check browser console for cache details';
                });
            });
            
            document.getElementById('clearCacheBtn').addEventListener('click', function() {
                if ('caches' in window) {
                    caches.keys().then(cacheNames => {
                        return Promise.all(
                            cacheNames.map(cacheName => {
                                return caches.delete(cacheName);
                            })
                        );
                    }).then(() => {
                        document.getElementById('debugOutput').textContent = 'All caches cleared';
                    });
                }
            });
            
            document.getElementById('reloadSWBtn').addEventListener('click', function() {
                if ('serviceWorker' in navigator) {
                    navigator.serviceWorker.getRegistrations().then(registrations => {
                        for (let registration of registrations) {
                            registration.unregister();
                        }
                        window.location.reload();
                        document.getElementById('debugOutput').textContent = 'Service Worker unregistered, reloading...';
                    });
                }
            });
        });
    </script>
    
    <script src="script.js"></script>
    <script src="pwa.js"></script>
</body>
</html>

